package org.campagnelab.hta.script.behavior;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.build.util.Context;
import jetbrains.mps.build.util.RelativePathHelper;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import java.util.Set;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import java.util.HashSet;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.internal.collections.runtime.ITranslator2;
import jetbrains.mps.smodel.behaviour.BehaviorReflection;
import jetbrains.mps.smodel.behaviour.BehaviorManager;

public class Script_Behavior {
  public static void init(SNode thisNode) {
    SLinkOperations.setTarget(thisNode, "statements", SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.StatementList", null), true);
  }

  @Nullable
  public static String call_getScriptsPath_4796668409958419284(SNode thisNode, Context context) {
    return Script_Behavior.call_getBasePath_4959435991187146924(thisNode, context);
  }

  @Nullable
  public static String call_getBasePath_4959435991187146924(SNode thisNode, Context context) {
    RelativePathHelper relativePathHelper = context.getRelativePathHelper(SNodeOperations.getModel(thisNode));
    if (relativePathHelper == null) {
      // model is packaged, i.e. no base path for it 
      return null;
    }
    return relativePathHelper.getBasePath();
  }

  public static String call_getOutputFileName_4915877860351551360(SNode thisNode) {
    return SPropertyOperations.getString(thisNode, "name") + "_script.R";
  }

  public static Iterable<String> virtual_dependencies_7074867102585843604(SNode thisNode) {
    // return any package that script components depend upon 
    Set<String> uniquePackageList = SetSequence.fromSet(new HashSet<String>());
    SetSequence.fromSet(uniquePackageList).addSequence(ListSequence.fromList(SNodeOperations.getDescendants(thisNode, "org.campagnelab.hta.script.structure.Statement", false, new String[]{})).translate(new ITranslator2<SNode, String>() {
      public Iterable<String> translate(SNode statement) {
        return BehaviorReflection.invokeVirtual((Class<Iterable<String>>) ((Class) Object.class), statement, "virtual_dependencies_6853668812000956111", new Object[]{});
      }
    }));
    return SetSequence.fromSet(uniquePackageList).distinct();
  }

  @Deprecated
  public static Iterable<String> call_dependencies_7074867102585843604(SNode thisNode) {
    return BehaviorReflection.invokeVirtual((Class<Iterable<String>>) ((Class) Object.class), thisNode, "virtual_dependencies_7074867102585843604", new Object[]{});
  }

  @Deprecated
  public static Iterable<String> callSuper_dependencies_7074867102585843604(SNode thisNode, String callerConceptFqName) {
    return BehaviorManager.getInstance().invokeSuper((Class<Iterable<String>>) ((Class) Object.class), SNodeOperations.cast(thisNode, "org.campagnelab.hta.script.structure.Script"), callerConceptFqName, "virtual_dependencies_7074867102585843604", new Class[]{SNode.class}, new Object[]{});
  }
}
